<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Sunrise and Sunset in San Antonio, TX | Data Science Research Circle</title>
  <meta name="description" content="This is an exploratory data report on police traffic data." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Sunrise and Sunset in San Antonio, TX | Data Science Research Circle" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is an exploratory data report on police traffic data." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Sunrise and Sunset in San Antonio, TX | Data Science Research Circle" />
  
  <meta name="twitter:description" content="This is an exploratory data report on police traffic data." />
  

<meta name="author" content="Pomona College Data Science Research Circle" />


<meta name="date" content="2020-05-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="socioeconomic-factors-in-durham-1.html"/>
<link rel="next" href="methods.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>2</b> Functions</a><ul>
<li class="chapter" data-level="2.1" data-path="functions.html"><a href="functions.html#data-uploading-functions"><i class="fa fa-check"></i><b>2.1</b> Data Uploading Functions</a></li>
<li class="chapter" data-level="2.2" data-path="functions.html"><a href="functions.html#veil-of-darkness-functions"><i class="fa fa-check"></i><b>2.2</b> Veil of Darkness Functions</a></li>
<li class="chapter" data-level="2.3" data-path="functions.html"><a href="functions.html#nationwide-functions"><i class="fa fa-check"></i><b>2.3</b> Nationwide Functions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="description-of-data.html"><a href="description-of-data.html"><i class="fa fa-check"></i><b>3</b> Description of Data</a><ul>
<li class="chapter" data-level="3.1" data-path="description-of-data.html"><a href="description-of-data.html#querying-datasets-with-rmysql"><i class="fa fa-check"></i><b>3.1</b> Querying Datasets with RMySQL</a><ul>
<li class="chapter" data-level="3.1.1" data-path="description-of-data.html"><a href="description-of-data.html#querying-subsets-of-dataset"><i class="fa fa-check"></i><b>3.1.1</b> Querying Subsets of dataset</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="description-of-data.html"><a href="description-of-data.html#web-scrapping-and-uploading-datasets"><i class="fa fa-check"></i><b>3.2</b> Web Scrapping and Uploading Datasets</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>4</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="4.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#stop-outcomes-day-to-night-in-oakland-ca"><i class="fa fa-check"></i><b>4.1</b> Stop outcomes, day-to-night, in Oakland, CA</a></li>
<li class="chapter" data-level="4.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#dataset-specific-exploration"><i class="fa fa-check"></i><b>4.2</b> Dataset-specific Exploration</a><ul>
<li class="chapter" data-level="4.2.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#stop-outcomes-in-san-diego"><i class="fa fa-check"></i><b>4.2.1</b> Stop outcomes in San Diego</a></li>
<li class="chapter" data-level="4.2.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#weather-overlay-in-raleigh"><i class="fa fa-check"></i><b>4.2.2</b> Weather Overlay in Raleigh</a></li>
<li class="chapter" data-level="4.2.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#common-violations-and-map-visualisations-in-san-antonio-tx"><i class="fa fa-check"></i><b>4.2.3</b> Common Violations and Map Visualisations in San Antonio, TX</a></li>
<li class="chapter" data-level="4.2.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#socioeconomic-factors-in-durham"><i class="fa fa-check"></i><b>4.2.4</b> Socioeconomic Factors in Durham</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="socioeconomic-factors-in-durham-1.html"><a href="socioeconomic-factors-in-durham-1.html"><i class="fa fa-check"></i><b>5</b> Socioeconomic Factors in Durham</a><ul>
<li class="chapter" data-level="5.1" data-path="socioeconomic-factors-in-durham-1.html"><a href="socioeconomic-factors-in-durham-1.html#modeling-the-probability-of-seach-given-stop"><i class="fa fa-check"></i><b>5.1</b> Modeling the Probability of Seach Given Stop</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sunrise-and-sunset-in-san-antonio-tx.html"><a href="sunrise-and-sunset-in-san-antonio-tx.html"><i class="fa fa-check"></i><b>6</b> Sunrise and Sunset in San Antonio, TX</a></li>
<li class="chapter" data-level="7" data-path="methods.html"><a href="methods.html"><i class="fa fa-check"></i><b>7</b> Methods</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="8" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>8</b> Final Words</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science Research Circle</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sunrise-and-sunset-in-san-antonio-tx" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Sunrise and Sunset in San Antonio, TX</h1>
<p>During night times when the sun is set, researchers speculate that stops are made by police officers without the acknowledgment of the racial identity of the driver. This should be the exact opposite for police officers during the day times. With the hope of identifying possible underlying racial discrimination with the available stop data, it has therefore been determined that for a specific region, the differences between the percentage of minority drivers within day times and night times could be used to detect such discrimination. The central idea is that, by observing the distribution of the difference values through the progression of time, we can gain a better understanding of the change of police behaviors with the transformation from day times to night times.</p>
<p>The calculation of the difference for this research project is set to be the daytime percentage of minority drivers (black) being stopped deducted by that of the night time percentage. A positive difference value indicates that if the police officer is able to identify the identity of the driver (i.e., under the day times), she or he has a higher percentage chance of stopping the minority driver. Whereas during the night times with a lack of sufficient light source, we assumed that the police officer was unable to identify the driver’s race. Therefore, if there exists racial discrimination against minority drivers, we should expect to observe that a significant proportion of percentage differences should be positive. However, if the visualization shows an opposite distribution, then we have to conclude that the division of day time and night time has failed to capture the existence of racial discrimination.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-1"></a>SAN &lt;-<span class="st"> </span>SAN <span class="op">%&gt;%</span></span>
<span id="cb93-2"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">date2 =</span> lubridate<span class="op">::</span><span class="kw">as_date</span>(lubridate<span class="op">::</span><span class="kw">ymd</span>(<span class="kw">as.character</span>(date)))) </span>
<span id="cb93-3"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-3"></a></span>
<span id="cb93-4"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-4"></a>SAN &lt;-<span class="st"> </span>SAN <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">date_time =</span> <span class="kw">as.POSIXct</span>(<span class="kw">paste</span>(date, time), <span class="dt">tz =</span> <span class="st">&quot;America/Chicago&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d %H:%M:%OS&quot;</span>))</span>
<span id="cb93-5"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-5"></a></span>
<span id="cb93-6"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-6"></a>oursunriseset &lt;-<span class="st"> </span><span class="cf">function</span>(latitude, longitude, date, <span class="dt">direction =</span> <span class="kw">c</span>(<span class="st">&quot;sunrise&quot;</span>, <span class="st">&quot;sunset&quot;</span>)) {</span>
<span id="cb93-7"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-7"></a>  date.lat.long &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">date =</span> date, <span class="dt">lat =</span> latitude, <span class="dt">lon =</span> longitude)</span>
<span id="cb93-8"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-8"></a>  <span class="cf">if</span>(direction <span class="op">==</span><span class="st"> &quot;sunrise&quot;</span>){</span>
<span id="cb93-9"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-9"></a>    x &lt;-<span class="st"> </span><span class="kw">getSunlightTimes</span>(<span class="dt">data =</span> date.lat.long, <span class="dt">keep=</span>direction, <span class="dt">tz=</span><span class="st">&quot;America/Chicago&quot;</span>)<span class="op">$</span>sunrise }<span class="cf">else</span>{</span>
<span id="cb93-10"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-10"></a>    x &lt;-<span class="st"> </span><span class="kw">getSunlightTimes</span>(<span class="dt">data =</span> date.lat.long, <span class="dt">keep=</span>direction, <span class="dt">tz=</span><span class="st">&quot;America/Chicago&quot;</span>)<span class="op">$</span>sunset  }</span>
<span id="cb93-11"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-11"></a>  <span class="kw">return</span>(x)</span>
<span id="cb93-12"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-12"></a>}</span>
<span id="cb93-13"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-13"></a></span>
<span id="cb93-14"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-14"></a>sunrise &lt;-<span class="st"> </span><span class="kw">oursunriseset</span>(<span class="fl">29.4241</span>, <span class="fl">-98.4936</span>, SAN<span class="op">$</span>date2, <span class="dt">direction =</span> <span class="st">&quot;sunrise&quot;</span>)</span>
<span id="cb93-15"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-15"></a>sunset &lt;-<span class="st"> </span><span class="kw">oursunriseset</span>(<span class="fl">29.4241</span>, <span class="fl">-98.4936</span>, SAN<span class="op">$</span>date2, <span class="dt">direction =</span> <span class="st">&quot;sunset&quot;</span>)</span>
<span id="cb93-16"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-16"></a></span>
<span id="cb93-17"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-17"></a>SAN &lt;-<span class="st"> </span><span class="kw">cbind</span>(SAN, sunrise, sunset)</span>
<span id="cb93-18"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-18"></a></span>
<span id="cb93-19"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-19"></a>SAN &lt;-<span class="st"> </span>SAN <span class="op">%&gt;%</span></span>
<span id="cb93-20"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-20"></a><span class="kw">mutate</span>(<span class="dt">light =</span> <span class="kw">ifelse</span>(date_time <span class="op">&lt;</span><span class="st"> </span>sunrise, <span class="st">&quot;night&quot;</span>, <span class="kw">ifelse</span>(date_time <span class="op">&gt;</span><span class="st"> </span>sunset, <span class="st">&quot;night&quot;</span>, <span class="st">&quot;day&quot;</span>)))</span>
<span id="cb93-21"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-21"></a></span>
<span id="cb93-22"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-22"></a>racial_perc &lt;-<span class="st"> </span><span class="cf">function</span>(mon, yr, race){</span>
<span id="cb93-23"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-23"></a>  x1 &lt;-<span class="st"> </span><span class="kw">filter</span>(SAN, light <span class="op">==</span><span class="st"> &quot;day&quot;</span>, month <span class="op">==</span><span class="st"> </span>mon, year <span class="op">==</span><span class="st"> </span>yr)</span>
<span id="cb93-24"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-24"></a>  x1 &lt;-<span class="st"> </span><span class="kw">prop.table</span>(<span class="kw">table</span>(x1<span class="op">$</span>subject_race)) </span>
<span id="cb93-25"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-25"></a>  x1 &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(x1)</span>
<span id="cb93-26"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-26"></a>  x1 &lt;-<span class="st"> </span><span class="kw">filter</span>(x1, Var1 <span class="op">==</span><span class="st"> </span>race)<span class="op">$</span>Freq</span>
<span id="cb93-27"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-27"></a>  </span>
<span id="cb93-28"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-28"></a>  x2 &lt;-<span class="st"> </span><span class="kw">filter</span>(SAN,light <span class="op">==</span><span class="st"> &quot;night&quot;</span>, month <span class="op">==</span><span class="st"> </span>mon, year <span class="op">==</span><span class="st"> </span>yr)</span>
<span id="cb93-29"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-29"></a>  x2 &lt;-<span class="st"> </span><span class="kw">prop.table</span>(<span class="kw">table</span>(x2<span class="op">$</span>subject_race)) </span>
<span id="cb93-30"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-30"></a>  x2 &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(x2)</span>
<span id="cb93-31"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-31"></a>  x2 &lt;-<span class="st"> </span><span class="kw">filter</span>(x2, Var1 <span class="op">==</span><span class="st"> </span>race)<span class="op">$</span>Freq</span>
<span id="cb93-32"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-32"></a>  </span>
<span id="cb93-33"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-33"></a>  <span class="kw">return</span>(x1<span class="op">-</span>x2)</span>
<span id="cb93-34"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-34"></a>}</span>
<span id="cb93-35"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-35"></a></span>
<span id="cb93-36"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-36"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>()</span>
<span id="cb93-37"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-37"></a>y &lt;-<span class="st"> </span><span class="kw">c</span>()</span>
<span id="cb93-38"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-38"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>()</span>
<span id="cb93-39"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-39"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq</span>(<span class="dv">2012</span>,<span class="dv">2017</span>)){</span>
<span id="cb93-40"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-40"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">12</span>)){</span>
<span id="cb93-41"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-41"></a>    diff &lt;-<span class="st"> </span><span class="kw">racial_perc</span>(j,i,<span class="st">&quot;black&quot;</span>)</span>
<span id="cb93-42"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-42"></a>    x &lt;-<span class="st"> </span><span class="kw">c</span>(x, diff)</span>
<span id="cb93-43"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-43"></a>    y &lt;-<span class="st"> </span><span class="kw">c</span>(y,i)</span>
<span id="cb93-44"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-44"></a>    z &lt;-<span class="st"> </span><span class="kw">c</span>(z,j)</span>
<span id="cb93-45"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-45"></a>  }</span>
<span id="cb93-46"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-46"></a>}</span>
<span id="cb93-47"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-47"></a></span>
<span id="cb93-48"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-48"></a>diff_data_SAN &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(x,y,z))</span>
<span id="cb93-49"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-49"></a>diff_data_SAN &lt;-<span class="st"> </span>diff_data_SAN <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">time =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(diff_data_SAN))</span>
<span id="cb93-50"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-50"></a></span>
<span id="cb93-51"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-51"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>()</span>
<span id="cb93-52"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-52"></a>y &lt;-<span class="st"> </span><span class="kw">c</span>()</span>
<span id="cb93-53"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-53"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>()</span>
<span id="cb93-54"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-54"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">4</span>)){</span>
<span id="cb93-55"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-55"></a>  diff &lt;-<span class="st"> </span><span class="kw">racial_perc</span>(i,<span class="st">&#39;2018&#39;</span>,<span class="st">&quot;black&quot;</span>)</span>
<span id="cb93-56"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-56"></a>  x &lt;-<span class="st"> </span><span class="kw">c</span>(x, diff)</span>
<span id="cb93-57"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-57"></a>  z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb93-58"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-58"></a>  y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2018</span>, <span class="dv">2018</span>, <span class="dv">2018</span>, <span class="dv">2018</span>)</span>
<span id="cb93-59"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-59"></a>}</span>
<span id="cb93-60"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-60"></a></span>
<span id="cb93-61"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-61"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(diff_data_SAN)</span>
<span id="cb93-62"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-62"></a>diff_data_SAN2 &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(x,y,z))</span>
<span id="cb93-63"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-63"></a>diff_data_SAN2 &lt;-<span class="st"> </span>diff_data_SAN2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">time =</span> (n<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(n<span class="op">+</span><span class="dv">4</span>))</span>
<span id="cb93-64"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-64"></a>diff_data_SAN &lt;-<span class="st"> </span><span class="kw">rbind</span>(diff_data_SAN,diff_data_SAN2)</span>
<span id="cb93-65"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-65"></a></span>
<span id="cb93-66"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-66"></a></span>
<span id="cb93-67"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-67"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diff_data_SAN) <span class="op">+</span><span class="st"> </span></span>
<span id="cb93-68"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-68"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> x)) <span class="op">+</span></span>
<span id="cb93-69"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb93-69"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="dv">0</span>, <span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-80-1.png" width="672" /></p>
<p>The policing data used for the visualization is from Sanantonio, Texas, and the date is from January 2012 to April 2018. This data recorded a total number of 1,040,428 observations. Key variables are the date of the stop made and the race of the driver, and the corresponding sunrise and sunset time were calculated with each of the given dates. If the stop took place after the sunrise time and before the sunset time, it was set to be a stop made during the day time. Stops that took place outside of this range were set to be night time stops. Then for each day, the percentage of black drivers stopped during day and night was separately calculated and their difference was documented. Finally, the visualization of the key variables was a scatter plot with the horizontal axis as the progression of time and the vertical axis as the day time percentage deducted by night time percentage. For us to claim that the plot has successfully captured the possible existence of racial discrimination, we should expect to observe the majority of the points to be above the horizontal line at zero. However, the scatter plot demonstrates a trend contrary to our expectations. Most of the points fall under the horizontal line, which indicates that for the region of Sanantonio, black drivers on average were stopped at a lower percentage during day time than night time. Using this method and the given data, we have failed the attempt to prove that there has been racial discrimination against black drivers within the data.</p>
<p>One possible downfall of the aforementioned method is that it failed to acknowledge the possible difference in the distribution of driver populations between day time and night time. More specifically speaking, it is likely that for the region of Sanantonio, drivers who are on the road during night time and day time are two completely different population groups, and therefore, comparing the percentages of drivers stopped between these two possibly distinct population might be less meaningful. One possible improvement in the hope of alleviating population distinctions is the “veil of darkness” test, which limits to the stops made only one hour before and after the sunset time. This approach helps to reduce the possible distinction in the racial distribution of the night time and day time drivers. A similar set of procedures to the previous method was conducted, and a second scatter plot was produced. For the second time, the majority of the points are still below the horizontal line, which indicates that even if we have attempted to reduce the possible transformation of racial distribution, black drivers were mostly stopped at a higher percentage during night time relative to that of the day time. Therefore, the second plot has also failed to offer evidence for the existence of racial discrimination in the data for Sanantonio.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-1"></a>SAN2 &lt;-<span class="st"> </span>SAN <span class="op">%&gt;%</span></span>
<span id="cb94-2"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-2"></a><span class="st">  </span><span class="kw">filter</span>(sunset<span class="dv">-3600</span> <span class="op">&lt;</span><span class="st"> </span>date_time <span class="op">&amp;</span><span class="st"> </span>sunset <span class="op">+</span><span class="st"> </span><span class="dv">3600</span> <span class="op">&gt;</span><span class="st"> </span>date_time)</span>
<span id="cb94-3"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-3"></a></span>
<span id="cb94-4"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-4"></a>racial_perc2 &lt;-<span class="st"> </span><span class="cf">function</span>(mon, yr, race){</span>
<span id="cb94-5"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-5"></a>  x1 &lt;-<span class="st"> </span><span class="kw">filter</span>(SAN2, light <span class="op">==</span><span class="st"> &quot;day&quot;</span>, month <span class="op">==</span><span class="st"> </span>mon, year <span class="op">==</span><span class="st"> </span>yr)</span>
<span id="cb94-6"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-6"></a>  x1 &lt;-<span class="st"> </span><span class="kw">prop.table</span>(<span class="kw">table</span>(x1<span class="op">$</span>subject_race)) </span>
<span id="cb94-7"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-7"></a>  x1 &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(x1)</span>
<span id="cb94-8"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-8"></a>  x1 &lt;-<span class="st"> </span><span class="kw">filter</span>(x1, Var1 <span class="op">==</span><span class="st"> </span>race)<span class="op">$</span>Freq</span>
<span id="cb94-9"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-9"></a>  </span>
<span id="cb94-10"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-10"></a>  x2 &lt;-<span class="st"> </span><span class="kw">filter</span>(SAN2,light <span class="op">==</span><span class="st"> &quot;night&quot;</span>, month <span class="op">==</span><span class="st"> </span>mon, year <span class="op">==</span><span class="st"> </span>yr)</span>
<span id="cb94-11"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-11"></a>  x2 &lt;-<span class="st"> </span><span class="kw">prop.table</span>(<span class="kw">table</span>(x2<span class="op">$</span>subject_race)) </span>
<span id="cb94-12"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-12"></a>  x2 &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(x2)</span>
<span id="cb94-13"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-13"></a>  x2 &lt;-<span class="st"> </span><span class="kw">filter</span>(x2, Var1 <span class="op">==</span><span class="st"> </span>race)<span class="op">$</span>Freq</span>
<span id="cb94-14"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-14"></a>  </span>
<span id="cb94-15"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-15"></a>  <span class="kw">return</span>(x1<span class="op">-</span>x2)</span>
<span id="cb94-16"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-16"></a>}</span>
<span id="cb94-17"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-17"></a></span>
<span id="cb94-18"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-18"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>()</span>
<span id="cb94-19"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-19"></a>y &lt;-<span class="st"> </span><span class="kw">c</span>()</span>
<span id="cb94-20"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-20"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>()</span>
<span id="cb94-21"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-21"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq</span>(<span class="dv">2012</span>,<span class="dv">2017</span>)){</span>
<span id="cb94-22"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-22"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">12</span>)){</span>
<span id="cb94-23"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-23"></a>    diff &lt;-<span class="st"> </span><span class="kw">racial_perc</span>(j,i,<span class="st">&quot;black&quot;</span>)</span>
<span id="cb94-24"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-24"></a>    x &lt;-<span class="st"> </span><span class="kw">c</span>(x, diff)</span>
<span id="cb94-25"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-25"></a>    y &lt;-<span class="st"> </span><span class="kw">c</span>(y,i)</span>
<span id="cb94-26"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-26"></a>    z &lt;-<span class="st"> </span><span class="kw">c</span>(z,j)</span>
<span id="cb94-27"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-27"></a>  }</span>
<span id="cb94-28"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-28"></a>}</span>
<span id="cb94-29"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-29"></a></span>
<span id="cb94-30"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-30"></a>diff_data_SAN &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(x,y,z))</span>
<span id="cb94-31"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-31"></a>diff_data_SAN &lt;-<span class="st"> </span>diff_data_SAN <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">time =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(diff_data_SAN))</span>
<span id="cb94-32"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-32"></a></span>
<span id="cb94-33"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-33"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>()</span>
<span id="cb94-34"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-34"></a>y &lt;-<span class="st"> </span><span class="kw">c</span>()</span>
<span id="cb94-35"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-35"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>()</span>
<span id="cb94-36"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-36"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">4</span>)){</span>
<span id="cb94-37"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-37"></a>  diff &lt;-<span class="st"> </span><span class="kw">racial_perc2</span>(i,<span class="st">&#39;2018&#39;</span>,<span class="st">&quot;black&quot;</span>)</span>
<span id="cb94-38"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-38"></a>  x &lt;-<span class="st"> </span><span class="kw">c</span>(x, diff)</span>
<span id="cb94-39"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-39"></a>  z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb94-40"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-40"></a>  y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2018</span>, <span class="dv">2018</span>, <span class="dv">2018</span>, <span class="dv">2018</span>)</span>
<span id="cb94-41"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-41"></a>}</span>
<span id="cb94-42"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-42"></a></span>
<span id="cb94-43"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-43"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(diff_data_SAN)</span>
<span id="cb94-44"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-44"></a>diff_data_SAN2 &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(x,y,z))</span>
<span id="cb94-45"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-45"></a>diff_data_SAN2 &lt;-<span class="st"> </span>diff_data_SAN2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">time =</span> (n<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(n<span class="op">+</span><span class="dv">4</span>))</span>
<span id="cb94-46"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-46"></a>diff_data_SAN &lt;-<span class="st"> </span><span class="kw">rbind</span>(diff_data_SAN,diff_data_SAN2)</span>
<span id="cb94-47"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-47"></a></span>
<span id="cb94-48"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-48"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diff_data_SAN) <span class="op">+</span><span class="st"> </span></span>
<span id="cb94-49"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-49"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> x)) <span class="op">+</span></span>
<span id="cb94-50"><a href="sunrise-and-sunset-in-san-antonio-tx.html#cb94-50"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="dv">0</span>, <span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="socioeconomic-factors-in-durham-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="methods.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-combined.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
